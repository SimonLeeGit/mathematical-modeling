clear
clc
%利用线性方法求解最优化模型
C=(-1).*[0.0702    0.0994    0.0338    0.1390    0.0279    0.1306    0.1606...  
         0.0854    0.1182    0.1582    0.3770    0.6733    0.1467    0.2613...   
         0.1085    0.2481    0.2197    0.1306    1.8699    0.4921    0.1304...    
         0.1625    2.3186    0.3252    0.3193    0.7227    0.0782    0.1866...    
         0.1192    0.5148    0.2544    0.0433    0.6591    0.0547    0.1627...   
         0.0406    0.0028    0.9725    0.1320    0.2067    1.2581    1.2270...   
         0.9419    0.7435    4.4568    0.6184    0.4742    0.2680    0.1909...   
         0.4630    0.1292    0.2557    0.3597    0.4345    0.5182    0.4067...    
         0.1957    0.0444    0.1955    0.1227    0.0576    0.2100    0.1458...   
         0.1475    0.0910    0.3862    0.2247    0.0834    0.1393    0.1964...    
         0.3510    0.2522];%目标函数的系数距阵
a=zeros(9,72);
a(1,1:10)=ones(1,10);
a(2,11:20)=ones(1,10);
a(3,21:30)=ones(1,10);
a(4,31:40)=ones(1,10);
a(5,41:48)=ones(1,8);
a(6,49:54)=ones(1,6);
a(7,55:60)=ones(1,6);
a(8,61:66)=ones(1,6);
a(9,67:72)=ones(1,6);
A=[a;(-1).*a];
b1=[3*38;3*38;40*3;34*3;37*3;24*3;22*2;21*3;24*3];
b2=[110;66;222;118;72;76;40;40;40]./2.*(-1);
b=[b1;b2];
Aeq=ones(1,72);
beq=500;                %总社的书号数
r=[0.4480  0.4462  0.8296  0.8113  0.6883  0.5683  0.3980  0.3433  0.2530...
   0.3061  0.5541  0.4889  0.4742  0.3920  0.4463  0.4757  0.5614  0.3584...
   0.4773  0.5080  0.5533  0.4899  0.5457  0.3957  0.4232  0.4801  0.3440...
   0.7255  0.4449  0.4749  0.3156  0.5699  1.2715  0.4098  0.6070  0.5019...
   0.9435  0.4479  0.6094  0.9935  0.4532  0.6227  0.5971  0.6486  0.5520...
   0.3548  0.4312  0.5617  0.5084  0.5157  0.4569  0.5220  0.3679  0.3392...
   1.1376  0.5174  0.3241  0.7080  0.5533  0.3549  0.4474  0.5320  0.3491...
   0.3599  0.5395  0.3464  0.4643  0.4329  0.5689  0.7308  0.3461  0.6579]';%1-72课程的准确度
%06年1-72课程的计划书号数
J=[18  18   4   6   6  16  12   6  16   8   8   4   4   4   6   6   6   8   6   4  12  38  52   8  24  34  12   6  24  12  40   4   2  22   8  16  6   6  10   6   4  10   8  10   6   8  12  14  18   4  10  16   4   8   4   4   4   4   4  10   8   8   8   8   4   4   8  10   8   6   4   4]';
E=ones(72,1);
vlb=ceil(J.*(E-r));
% vlb=zeros(72,1);
vlb(4)=3;vlb(13)=3;vlb(20)=3;vlb(28)=3;vlb(40)=3;vlb(56)=2;vlb(70)=5;
vub=[18;18;4;6;6;16;12;6;16;8;8;4;4;4;6;6;6;8;6;4;12;38;52;8;24;34;12;6;24;
     12;40;4;2;22;8;16;6;6;10;6;4;10;8;10;6;8;12;14;18;4;10;16;4;8;4;4;4;4;
     4;10;8;8;8;8;4;4;8;10;8;6;4;4];
vub(3)=3;vub(37)=5;vub(50)=2;vub(55)=1;vub(58)=2;
[x,fval]=linprog(C,A,b,Aeq,beq,vlb,vub)   %求解最优值，即各门课程所对应的书号
s1=sum(x(1:10,1))
s2=sum(x(11:20,1))
s3=sum(x(21:30,1))
s4=sum(x(31:40,1))
s5=sum(x(41:48,1))
s6=sum(x(49:54,1))
s7=sum(x(55:60,1))
s8=sum(x(61:66,1))
s9=sum(x(67:72,1))                         %s1-s9表示各分社所分到的总书号数
l=1:72;
bar(l,x)
title('各社分到的书号数所占比例图');
xlabel('各个学科l');
ylabel('书号数x');
figure(2)
X=1:72;
Y= [2.8670    2.8610    1.8767    3.0007    2.7067    2.9544    2.7571    2.8700    2.8751    2.8877    2.9360    2.8579    3.0101    2.8084...
    2.8422    2.8941    2.8919    2.8051    2.9124    3.0635    2.9604    2.9209    2.9083    2.8853    2.9371    2.9388    2.9501    2.9944...
    2.8759    2.8990    2.9216    2.6700    2.5140    2.8173    2.9223    2.9742    2.1830    2.7991    2.8809    3.1857    2.9344    2.8968...
    2.9033    2.9079    2.9031    2.9184    2.8569    2.9445    2.8201    1.6533    2.8492    2.9180    2.8227    2.9691    1.5000    2.7892...
    2.9489    1.8400    3.0336    2.9121    2.8980    2.9929    2.9247    2.9027    2.5627    2.8720    2.9031    2.8373    2.8919    3.0146...
    2.7493    2.8479];
plot(X,Y)
axis([1,72,1,4]);
title('各科课程的满意度趋势图');
xlabel('各个学科X');
ylabel('其满意度Y');
